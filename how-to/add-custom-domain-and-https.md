---
layout: layouts/base.njk
title: Add a Custom Domain and HTTPS to Your Website
---
# {{ title }}

## Overview

> Note: This tutorial assumes you've already completed the steps in [Create a Static Website][].

Adding a custom domain and [HTTPS][] to your [AWS website][] can lend some polish and professionalism. It's also a good idea since Google Chrome (and possibly other browsers) have started to warn users about non-secure HTTP sites.

In addition to [S3][], there are a few key AWS services we'll need to wire up this type of architecture:

* [Certificate Manager][] to create an [SSL certificate][] (which provides the "S" in HTTPS)
* [CloudFront][], a [content delivery network][] that is capable of routing SSL traffic to an S3 bucket set up as a website 
* [Route 53][] to purchase a custom domain name and route traffic to CloudFront (which in turn routes to our S3 bucket)

The overall architecture sounds a bit complicated, but it boils down to this:

```
    User -> mydomain.com (Route53) -> CloudFront domain -> S3
```

And the good news is that because we're using AWS, the overall process is dramatically simpler than a more traditional strategy that involves separately purchasing a domain and (pricey) SSL certificate, setting up a web server, and configuring [DNS][].

[HTTPS]: https://en.wikipedia.org/wiki/HTTPS
[AWS website]: https://data-driven/how-to/create-a-static-website/
[S3]: https://aws.amazon.com/s3/
[Create a Static Website]: https://data-driven/how-to/create-a-static-website/
[Certificate Manager]: https://aws.amazon.com/certificate-manager/
[SSL certificate]: https://en.wikipedia.org/wiki/Public_key_certificate
[CloudFront]: https://aws.amazon.com/cloudfront/
[content delivery network]: https://en.wikipedia.org/wiki/Content_delivery_network
[Route 53]: https://aws.amazon.com/route53/
[DNS]: https://en.wikipedia.org/wiki/Domain_Name_System

## Get a custom domain

* Sign into the AWS console using the Administrator account you set up in the [Create a Static Website][] tutorial.
* Go to [Route 53][] and [purchase/register a domain][]. Steer clear of `.io` domains to avoid [headaches](https://docs.aws.amazon.com/acm/latest/userguide/troubleshoot-iodomains.html).

> Note: You don't necessarily have to purchase a domain through Route 53, but it dramatically simplifies donwstsream DNS configuration.

[purchase/register a domain]: https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-register.html

## Acquire an SSL certificate for your domain

Go to the AWS [Certificate Manager][] service to [request a public SSL certificate][] for your domain.

**During this process, you must supply the domain name you purchased (e.g. data-driven.news) in the prior step of the tutorial.**

Additionally, you must validate the certificate by proving that you own the associated domain. This process is especially easy if you purchased a domain through Route 53 (as mentioned above). When validating, use the [DNS validation method][],
which simplifies the process of setting up DNS records for validation of domains purchased through Route 53.

[request a public SSL certificate]: https://docs.aws.amazon.com/acm/latest/userguide/gs-acm-request-public.html
[DNS validation method]: https://docs.aws.amazon.com/acm/latest/userguide/gs-acm-validate-dns.html

## Set up HTTPS

The final few steps involve using AWS [Route 53][] and [CloudFront][] to route viewers of your custom domain to the S3 bucket you set up at the beginning of this process.

This involves:

* Setting up a CloudFront "distribution", which routes traffic to your S3 bucket.
* Updating Route 53 DNS settings to point your custom domain to an (intermediate) domain provided by CloudFront.

### Create a CloudFront Distribution

Follow [these steps][] to set up a CloudFront distribution that can serve HTTPS requests for the S3 bucket.

When setting up a CloudFront distribution, you will get dropdown menus that let you select the domain created by Route 53 and the associated SSL certificate created via AWS [Certificate Manager][]. 

Some important notes about the setup process:

* Set the `Origin Domain` value to the bucket's *website domain*, rather than the standard S3 bucket domain. This will allow you to ensure that the "clean URL" behavior for `index.html` files works. For example:
  ```
  # Do this
  example.com.s3-website-us-east-1.amazonaws.com/

  # NOT this
  s3.amazonaws.com/example.com/index.html
  ```
* Set the `Price Class` to use only U.S., Canada and Europe (in order to minimize costs)

After you've created the distribution, you must go to [Route 53][] and create an [Alias][] record that routes traffic from your purchased domain to the CloudFront domain you just created. This last step is noted without much emphasis 
in the [set up a distribution][] docs.

Before heading to Route 53, be sure to grab the unique domain name generated by CloudFront. This can be retrieved by:

* Navigating to the CloudFront console
* Clicking `Distributions` in the upper left corner of the page
* Copying the value under the `Domain Name` column for your new distribution

Stash this domain away. You'll need it in the next step.

### Create Route 53 Alias

For this final step, you must create a DNS [Alias][] record in Route 53 that points
all traffic from your domain to the CloudFront-generated domain. 

* Navigate to [Route 53][] in the AWS console
* Click on `Registered domains` in the left navigation
* Click on the name of your domain
* Click `Manage DNS`. This will take you to the "Hosted Zones" area
* Click on the Hosted Zone entry for your domain (this Hosted Zone should have automatically been created when you first registered the domain)
* Click `Create Record Set`. A data entry form should appear in the right panel.
* Fill in the form as follows:
  * **Type** - "A - IPv4 Address"
  * **Alias** - Yes
  * **Alias target** - Provide the domain created by CloudFront, e.g. `d28y8kg5ghli2n.cloudfront.net` (see the CloudFront instructions above on how to retrieve this value) 
* Leave the other values in their default settings and click `Save Record Set`

## Summary

If all these steps went smoothly, you should have a shiny new domain that serves your S3-hosted website over HTTPS. 
This should lend a degree of professionalism to your new site. However, it's important to note that this type of architecture
is not secure end-to-end. With the current setup, only the traffic between a user's browser and the CloudFront domain is encrypted. Communications inside the Amazon network between CloudFront and S3 continue to be performed over unsecured HTTP. This type of setup may not be appropriate for hosting sensitive files/information. But for a basic project site, we've chosen to make this trade-off on security to gain simplicity in setup and management of our static website.

[Alias]: https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-values-alias.html
[Amazon Web Services]: https://aws.amazon.com/
[AWS Administrator account]: https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/setting-up-cloudfront.html
[Simple Storage Service]: https://aws.amazon.com/s3/
[set up a distribution]: https://aws.amazon.com/premiumsupport/knowledge-center/cloudfront-https-requests-s3/#
[these steps]: https://aws.amazon.com/premiumsupport/knowledge-center/cloudfront-https-requests-s3/#